"0","n.Samples <- 100"
"0","G <- 30 # number of clusters"
"0","n <- 5 # number of observation per cluster"
"0","prop.m <- .50 # 50% missingness"
"0",""
"0",""
"0",""
"0","#### Generate two matrices of random normal variables from a multivariate normal distribution"
"0","#### with the desired covariance structure"
"0",""
"0",""
"0",""
"0","### Computing Y1,Y2,X by summing their respective within- and between-cluster components"
"0",""
"0","# random effects (between-cluster deviations)"
"0","mu.b=c(0,0,0)"
"0","Sigma.b=matrix(c(2,-1.22,0,-1.22,3,-0.69,0,-0.69,1), nrow = 3, byrow = TRUE)"
"0","Sigma.b"
"1","    "
"1","  [,1]"
"1","  [,2]"
"1","  [,3]"
"1","
[1,]"
"1","  2.00"
"1"," -1.22"
"1","  0.00"
"1","
[2,]"
"1"," -1.22"
"1","  3.00"
"1"," -0.69"
"1","
[3,]"
"1","  0.00"
"1"," -0.69"
"1","  1.00"
"1","
"
"0","set.seed(1234)"
"0","RandomBetween <- lapply(1:n.Samples, function(x) mvrnorm(G, mu.b, Sigma.b, tol = 1e-6, empirical = FALSE))"
"0","#RandomBetween"
"0",""
"0","# random error (with-in cluster deviations)"
"0","mu.w=c(0,0,0)"
"0","Sigma.w=matrix(c(18,11.02,0,11.02,27,6.24,0,6.24,9), nrow = 3, byrow = TRUE)"
"0","Sigma.w"
"1","    "
"1","  [,1]"
"1","  [,2]"
"1"," [,3]"
"1","
[1,]"
"1"," 18.00"
"1"," 11.02"
"1"," 0.00"
"1","
[2,]"
"1"," 11.02"
"1"," 27.00"
"1"," 6.24"
"1","
[3,]"
"1","  0.00"
"1","  6.24"
"1"," 9.00"
"1","
"
"0","set.seed(123)"
"0","RandomWithin <- lapply(1:n.Samples, function(x) mvrnorm(G*n, mu.w, Sigma.w, tol = 1e-6, empirical = FALSE))"
"0","#RandomWithin"
